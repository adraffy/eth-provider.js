function i(e=256){return new r(e,1)}function n(e){return[...e].map(e=>e.toString(16).padStart(2,"0")).join("")}function l(i){if(typeof i!=="string")throw TypeError("expected string");if(i.startsWith("0x")){if(i.length==2)throw new TypeError("expected digits");i=i.slice(2)}if(i.length&1){i=`0${i}`}let e=i.length>>1;let n=new Uint8Array(e);for(let t=0,r=0;t<e;t++){let e=parseInt(i.slice(r,r+=2),16);if(Number.isNaN(e))throw new TypeError("expected hex byte");n[t]=e}return n}function o(t){if(typeof t!=="string")throw TypeError("expected string");try{t=unescape(encodeURIComponent(t))}catch(e){throw new Error("malformed utf8",{cause:e})}let{length:r}=t;let i=new Uint8Array(r);for(let e=0;e<r;e++){i[e]=t.charCodeAt(e)}return i}function e(e){try{return decodeURIComponent(escape(String.fromCharCode(...e)))}catch(e){throw new Error("malformed utf8",{cause:e})}}class t{constructor(e,t){const r=1600;if(e&31)throw new Error("capacity % 32 != 0");if(e<0||e>=r)throw new Error(`capacity must be [0,${r})`);this.sponge=Array(50).fill(0);this.block_count=r-e>>5;this.block_index=0;this.suffix=t;this.ragged_block=0;this.ragged_shift=0}update(e){if(!(e instanceof Uint8Array)){if(e instanceof ArrayBuffer){e=new Uint8Array(e)}else if(Array.isArray(e)){e=Uint8Array.from(e)}else if(typeof e==="string"){e=o(e)}else{throw new TypeError("expected bytes")}}let t=0;let r=e.length;if(this.ragged_shift>0){t=this._add_ragged(e,0);if(t==r)return this}let{sponge:i,block_index:n,block_count:s}=this;for(;t+4<=r;t+=4){i[n++]^=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24;if(n==s){h(i);n=0}}this.block_index=n;if(t<r)this._add_ragged(e,t);return this}_add_ragged(e,t){let{ragged_shift:r,ragged_block:i}=this;let n=0;for(;t<e.length&&r<32;n++,t++,r+=8){i|=e[t]<<r}if(r==32){this._add_block(i);r=0;i=0}this.ragged_block=i;this.ragged_shift=r;return n}_add_block(e){let{sponge:t,block_index:r,block_count:i}=this;t[r++]^=e;if(r==i){h(t);r=0}this.block_index=r}finalize(){let{sponge:e,suffix:t,ragged_shift:r,block_index:i,block_count:n}=this;if(r){if(r==-1)return;t=this.ragged_block|t<<r}e[i]^=t;e[n-1]^=2147483648;h(e);this.ragged_shift=-1}}class r extends t{constructor(e,t){super(e<<1,t);this.size=e>>5}get hex(){return n(this.bytes)}get bytes(){this.finalize();let{size:t,sponge:r}=this;let i=new Int32Array(t);for(let e=0;e<t;e++){i[e]=r[e]}return new Uint8Array(i.buffer)}}const fe=[1,0,32898,0,32906,-2147483648,-2147450880,-2147483648,32907,0,-2147483647,0,-2147450751,-2147483648,32777,-2147483648,138,0,136,0,-2147450871,0,-2147483638,0,-2147450741,0,139,-2147483648,32905,-2147483648,32771,-2147483648,32770,-2147483648,128,-2147483648,32778,0,-2147483638,-2147483648,-2147450751,-2147483648,32896,-2147483648,-2147483647,0,-2147450872,-2147483648];function h(ae){for(let he=0;he<48;he+=2){let e=ae[0]^ae[10]^ae[20]^ae[30]^ae[40];let t=ae[1]^ae[11]^ae[21]^ae[31]^ae[41];let r=ae[2]^ae[12]^ae[22]^ae[32]^ae[42];let i=ae[3]^ae[13]^ae[23]^ae[33]^ae[43];let n=ae[4]^ae[14]^ae[24]^ae[34]^ae[44];let s=ae[5]^ae[15]^ae[25]^ae[35]^ae[45];let l=ae[6]^ae[16]^ae[26]^ae[36]^ae[46];let o=ae[7]^ae[17]^ae[27]^ae[37]^ae[47];let h=ae[8]^ae[18]^ae[28]^ae[38]^ae[48];let a=ae[9]^ae[19]^ae[29]^ae[39]^ae[49];let f=h^(r<<1|i>>>31);let u=a^(i<<1|r>>>31);ae[0]^=f;ae[1]^=u;ae[10]^=f;ae[11]^=u;ae[20]^=f;ae[21]^=u;ae[30]^=f;ae[31]^=u;ae[40]^=f;ae[41]^=u;f=e^(n<<1|s>>>31);u=t^(s<<1|n>>>31);ae[2]^=f;ae[3]^=u;ae[12]^=f;ae[13]^=u;ae[22]^=f;ae[23]^=u;ae[32]^=f;ae[33]^=u;ae[42]^=f;ae[43]^=u;f=r^(l<<1|o>>>31);u=i^(o<<1|l>>>31);ae[4]^=f;ae[5]^=u;ae[14]^=f;ae[15]^=u;ae[24]^=f;ae[25]^=u;ae[34]^=f;ae[35]^=u;ae[44]^=f;ae[45]^=u;f=n^(h<<1|a>>>31);u=s^(a<<1|h>>>31);ae[6]^=f;ae[7]^=u;ae[16]^=f;ae[17]^=u;ae[26]^=f;ae[27]^=u;ae[36]^=f;ae[37]^=u;ae[46]^=f;ae[47]^=u;f=l^(e<<1|t>>>31);u=o^(t<<1|e>>>31);ae[8]^=f;ae[9]^=u;ae[18]^=f;ae[19]^=u;ae[28]^=f;ae[29]^=u;ae[38]^=f;ae[39]^=u;ae[48]^=f;ae[49]^=u;let c=ae[0];let d=ae[1];let g=ae[11]<<4|ae[10]>>>28;let w=ae[10]<<4|ae[11]>>>28;let y=ae[20]<<3|ae[21]>>>29;let b=ae[21]<<3|ae[20]>>>29;let p=ae[31]<<9|ae[30]>>>23;let m=ae[30]<<9|ae[31]>>>23;let x=ae[40]<<18|ae[41]>>>14;let _=ae[41]<<18|ae[40]>>>14;let E=ae[2]<<1|ae[3]>>>31;let A=ae[3]<<1|ae[2]>>>31;let U=ae[13]<<12|ae[12]>>>20;let T=ae[12]<<12|ae[13]>>>20;let k=ae[22]<<10|ae[23]>>>22;let v=ae[23]<<10|ae[22]>>>22;let C=ae[33]<<13|ae[32]>>>19;let R=ae[32]<<13|ae[33]>>>19;let S=ae[42]<<2|ae[43]>>>30;let z=ae[43]<<2|ae[42]>>>30;let I=ae[5]<<30|ae[4]>>>2;let N=ae[4]<<30|ae[5]>>>2;let $=ae[14]<<6|ae[15]>>>26;let M=ae[15]<<6|ae[14]>>>26;let W=ae[25]<<11|ae[24]>>>21;let j=ae[24]<<11|ae[25]>>>21;let B=ae[34]<<15|ae[35]>>>17;let q=ae[35]<<15|ae[34]>>>17;let J=ae[45]<<29|ae[44]>>>3;let L=ae[44]<<29|ae[45]>>>3;let O=ae[6]<<28|ae[7]>>>4;let D=ae[7]<<28|ae[6]>>>4;let F=ae[17]<<23|ae[16]>>>9;let G=ae[16]<<23|ae[17]>>>9;let H=ae[26]<<25|ae[27]>>>7;let K=ae[27]<<25|ae[26]>>>7;let P=ae[36]<<21|ae[37]>>>11;let Q=ae[37]<<21|ae[36]>>>11;let V=ae[47]<<24|ae[46]>>>8;let X=ae[46]<<24|ae[47]>>>8;let Y=ae[8]<<27|ae[9]>>>5;let Z=ae[9]<<27|ae[8]>>>5;let ee=ae[18]<<20|ae[19]>>>12;let te=ae[19]<<20|ae[18]>>>12;let re=ae[29]<<7|ae[28]>>>25;let ie=ae[28]<<7|ae[29]>>>25;let ne=ae[38]<<8|ae[39]>>>24;let se=ae[39]<<8|ae[38]>>>24;let le=ae[48]<<14|ae[49]>>>18;let oe=ae[49]<<14|ae[48]>>>18;ae[0]=c^~U&W;ae[1]=d^~T&j;ae[10]=O^~ee&y;ae[11]=D^~te&b;ae[20]=E^~$&H;ae[21]=A^~M&K;ae[30]=Y^~g&k;ae[31]=Z^~w&v;ae[40]=I^~F&re;ae[41]=N^~G&ie;ae[2]=U^~W&P;ae[3]=T^~j&Q;ae[12]=ee^~y&C;ae[13]=te^~b&R;ae[22]=$^~H&ne;ae[23]=M^~K&se;ae[32]=g^~k&B;ae[33]=w^~v&q;ae[42]=F^~re&p;ae[43]=G^~ie&m;ae[4]=W^~P&le;ae[5]=j^~Q&oe;ae[14]=y^~C&J;ae[15]=b^~R&L;ae[24]=H^~ne&x;ae[25]=K^~se&_;ae[34]=k^~B&V;ae[35]=v^~q&X;ae[44]=re^~p&S;ae[45]=ie^~m&z;ae[6]=P^~le&c;ae[7]=Q^~oe&d;ae[16]=C^~J&O;ae[17]=R^~L&D;ae[26]=ne^~x&E;ae[27]=se^~_&A;ae[36]=B^~V&Y;ae[37]=q^~X&Z;ae[46]=p^~S&I;ae[47]=m^~z&N;ae[8]=le^~c&U;ae[9]=oe^~d&T;ae[18]=J^~O&ee;ae[19]=L^~D&te;ae[28]=x^~E&$;ae[29]=_^~A&M;ae[38]=V^~Y&g;ae[39]=X^~Z&w;ae[48]=S^~I&F;ae[49]=z^~N&G;ae[0]^=fe[he];ae[1]^=fe[he+1]}}function s(t,r){let{length:i}=t;let n=i-r.length;for(let e=0;n==0&&e<i;e++)n=t[e]-r[e];return n}function a(e){if(typeof e!=="string")throw new TypeError("expected string");if(e.startsWith("0x"))e=e.slice(2);e=e.toLowerCase();if(!/^[a-f0-9]{40}$/.test(e))throw new TypeError("expected 40-char hex");let r=i().update(e).hex;return"0x"+[...e].map((e,t)=>r.charCodeAt(t)>=56?e.toUpperCase():e).join("")}class f{static zero(){return new this(new Uint8Array(32))}static from_number(e){return this.zero().set_number(e)}static from_bytes(e){return new this(d(e,32))}static from_hex(e){return this.from_bytes(l(e))}static from_dec(r){if(!/^[0-9]+$/.test(r))throw new TypeError("expected decimal digits");let t=r.length;if(t<10)this.from_number(parseInt(r,10));let i=new Uint8Array(Math.max(32,t));let n=0;for(let e=0;e<t;e++){let t=r.charCodeAt(e)-48;for(let e=0;e<n;e++){t+=i[e]*10;i[e]=t;t>>=8}while(t>0){i[n++]=t;t>>=8}}for(let r=Math.min(n,15);r>=0;r--){let e=31-r;let t=i[r];i[r]=i[e];i[e]=t}return new this(i.slice(0,32))}static from_str(e){return e.startsWith("0x")?this.from_hex(e):this.from_dec(e)}constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("expected bytes");if(e.length!=32)throw new TypeError("expected 32 bytes");this.bytes=e}compare(e){if(!(e instanceof f))throw new TypeError("expected Uint256");return s(this.bytes,e.bytes)}set_number(e){c(this.bytes,e);return this}get number(){return u(this.bytes)}get hex(){return"0x"+n(this.bytes)}get dec(){let i=[0];for(let r of this.bytes){for(let t=0;t<i.length;++t){let e=i[t]<<8|r;i[t]=e%10;r=e/10|0}while(r>0){i.push(r%10);r=r/10|0}}return String.fromCharCode(...i.reverse().map(e=>48+e))}toJSON(){return this.hex}toString(){return`Uint256(${this.hex})`}}function u(r){if(r.length>7){let t=r.length-7;for(let e=0;e<t;e++)if(r[e]>0)throw new RangeError("overflow");r=r.subarray(t)}let t=0;for(let e of r)t=t*256+e;if(!Number.isSafeInteger(t))throw new RangeError("overflow");return t}function c(t,r){if(!Number.isSafeInteger(r))throw new RangeError("overflow");if(r<0)throw new RangeError("underflow");for(let e=t.length-1;e>=0;e--){t[e]=r;r=Math.floor(r/256)}}function d(e,t){let{length:r}=e;if(r==t)return e.slice();if(r>t)return e.slice(t-r);let i=new Uint8Array(t);i.set(e,t-r);return i}function g(t,r){try{let e=y(t);if(e.length>r)return null;return d(e,r)}catch(e){return null}}function w(e){let{length:t}=e;let r=0;while(r<t&&e[r]==0)r++;return e.subarray(r)}function y(r){r=r.trim();if(r.startsWith("0x"))return w(l(r));let{length:t}=r;if(t==0)throw new Error("expected digits");let i=t+1>>1;let n=new Uint8Array(i);let s=i;for(let e=0;e<t;e++){let t=r.charCodeAt(e)-48;if(t<0||t>9)throw new Error("expected decimal digits");for(let e=i-1;e>=s;e--){t+=n[e]*10;n[e]=t;t>>=8}while(t>0){n[--s]=t;t>>=8}}return n.subarray(s)}async function b(e,t,r=null,i="latest"){if(typeof e!=="object")throw new TypeError("expected provider");if(typeof t==="string")t={to:t};if(r instanceof m)t.data=r.build_hex();try{return p.from_hex(await e.request({method:"eth_call",params:[t,i]}))}catch(e){if(e.code==-32e3&&e.message==="execution reverted"){e.reverted=true}throw e}}class p{static from_hex(e){return new this(l(e))}constructor(e){this.buf=e;this.pos=0}get remaining(){return this.buf.length-this.pos}read(e){let{pos:t,buf:r}=this;let i=t+e;if(i>r.length)throw new RangeError("buffer overflow");let n=r.subarray(t,i);this.pos=i;return n}byte(){let{pos:e,buf:t}=this;if(e>=t.length)throw new RangeError("buffer overflow");this.pos=e+1;return t[e]}boolean(){return this.number()>0}number(e=32){return u(this.read(e))}uint256(){return new f(this.read(32))}string(){return e(this.memory())}memory(){let e=this.number();let t=e+32;let{buf:r}=this;if(t>r.length)throw new RangeError("buffer overflow");let i=u(r.subarray(e,t));e=t;t+=i;if(t>r.length)throw new RangeError("buffer overflow");return r.subarray(e,t)}addr(e=true){if(this.number(12)!=0)throw new TypeError("expected zero");let t=this.read(20);let r=n(t);return e?a(r):`0x${r}`}uvarint(){let t=0;let r=1;const i=127;while(true){let e=this.byte();t+=(e&127)*r;if(e<=i)break;if(r>70368744177664)throw new RangeException("overflow");r*=128}return t}}class m{static method(e){if(typeof e!=="string")throw new TypeError("expected string");let t=4;let r=new m(t);if(e.includes("(")){r.add_bytes(i().update(e).bytes.subarray(0,t))}else{r.add_hex(e);if(r.pos!=t)throw new Error("method should be a signature or 8-char hex")}return r}constructor(e=0,t=256,r=false){if(!Number.isSafeInteger(t)||t<1)throw new TypeError("expected positive initial capacity");this.buf=new Uint8Array(t);this.pos=0;this.offset=e;this.tails=[]}reset(){this.buf.fill(0);this.tails.length=0;this.pos=0;return this}build_hex(){return"0x"+n(this.build())}build(){let{pos:i,tails:n,offset:s}=this;let e=n.reduce((e,[t,r])=>r.length,0);if(e>0){this.alloc(e);let{buf:r}=this;for(let[e,t]of n){c(r.subarray(e,e+32),i-s);r.set(t,i);i+=t.length}}return this.buf.subarray(0,i)}alloc(t){if(typeof t!=="number"||t<1)throw new TypeError("expected positive size");let{buf:r,pos:e}=this;let i=e+t;if(i>r.length){let e=new Uint8Array(Math.max(r.length+t,r.length<<1));e.set(r);this.buf=r=e}this.pos=i;return r.subarray(e,i)}bytes_hex(e){return this.bytes(l(e))}bytes(e){this.alloc(e.length+31&~31).set(e);return this}number(t,r=32){if(t instanceof f){let e=this.alloc(r);if(r<32){e.set(t.bytes.subarray(32-r))}else{e.set(t.bytes,r-32)}}else{c(this.alloc(r),t)}return this}string(e){return this.memory(o(e))}memory(e){let{pos:t}=this;this.alloc(32);let r=new Uint8Array(e.length+63&~31);c(r.subarray(0,32),e.length);r.set(e,32);this.tails.push([t,r]);return this}addr(e){let t=l(e);if(t.length!=20)throw new TypeError("expected address");this.alloc(32).set(t,12);return this}add_hex(e){return this.add_bytes(l(e))}add_bytes(e){if(!(e instanceof Uint8Array)){if(e instanceof ArrayBuffer){e=new Uint8Array(e)}else if(Array.isArray(e)){e=Uint8Array.from(e)}else{throw new TypeError("expected bytes")}}this.alloc(e.length).set(e);return this}}export{p as ABIDecoder,m as ABIEncoder,f as Uint256,g as bytes_from_digits_or_null,b as eth_call,d as left_truncate_bytes,y as parse_bytes_from_digits,c as set_bytes_to_unsigned,u as unsigned_from_bytes};